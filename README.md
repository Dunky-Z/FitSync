# Strava-Garmin åŒå‘åŒæ­¥å·¥å…·

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¤šå¹³å°è¿åŠ¨æ•°æ®åŒæ­¥å·¥å…·ï¼Œæ”¯æŒ Stravaã€Garmin Connect å’Œ IGPSport ä¹‹é—´çš„æ•°æ®åŒæ­¥ã€‚

## ğŸš€ ä¸»è¦åŠŸèƒ½

### 1. å•å‘ä¸Šä¼ ï¼ˆåŸæœ‰åŠŸèƒ½ï¼‰
- ä» Strava ä¸‹è½½æ´»åŠ¨æ–‡ä»¶
- ä¸Šä¼ åˆ° Garmin Connect å’Œ IGPSport
- æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼ˆFITã€TCXã€GPXï¼‰

### 2. åŒå‘åŒæ­¥ï¼ˆæ–°åŠŸèƒ½ï¼‰
- **Strava â†” Garmin Connect** åŒå‘è‡ªåŠ¨åŒæ­¥
- æ™ºèƒ½æ´»åŠ¨åŒ¹é…ï¼Œé¿å…é‡å¤åŒæ­¥
- å¢é‡åŒæ­¥ï¼Œåªå¤„ç†æ–°æ´»åŠ¨
- APIé™åˆ¶ç®¡ç†ï¼Œé¿å…è¶…å‡ºè°ƒç”¨é™åˆ¶
- æœ¬åœ°ç¼“å­˜ï¼Œæé«˜åŒæ­¥æ•ˆç‡

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### é¢å¤–ä¾èµ–è¯´æ˜

- **Garmin ConnectåŠŸèƒ½**éœ€è¦`garth`åº“ï¼š
  ```bash
  pip install garth
  ```

## ğŸ”§ é…ç½®

### Strava APIé…ç½®

1. è®¿é—® [Strava APIè®¾ç½®](https://www.strava.com/settings/api)
2. åˆ›å»ºåº”ç”¨ç¨‹åºè·å–Client IDå’ŒClient Secret
3. ä½¿ç”¨OAuthæµç¨‹è·å–Refresh Token
4. é…ç½®ä¼šè‡ªåŠ¨ä¿å­˜åˆ°`.app_config.json`

è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒï¼š[STRAVA_API_SETUP.md](STRAVA_API_SETUP.md)

### å¹³å°è´¦æˆ·

- **IGPSport**ï¼šéœ€è¦IGPSportè´¦æˆ·ï¼ˆæ”¯æŒä¸­å›½ç”¨æˆ·ï¼‰
- **Garmin Connect**ï¼šéœ€è¦Garmin Connectè´¦æˆ·
  - æ”¯æŒå…¨çƒç‰ˆ(garmin.com)å’Œä¸­å›½ç‰ˆ(garmin.cn)

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### å•å‘ä¸Šä¼ ï¼ˆå…¼å®¹åŸåŠŸèƒ½ï¼‰
```bash
cd src
python main_refactored.py
```

### åŒå‘åŒæ­¥ï¼ˆæ–°åŠŸèƒ½ï¼‰
```bash
cd src
python main_sync.py
```

#### äº¤äº’æ¨¡å¼
è¿è¡Œåé€‰æ‹©æ“ä½œï¼š
- **å¼€å§‹åŒå‘åŒæ­¥**: æ‰§è¡Œ Strava â†” Garmin åŒæ­¥
- **é…ç½®åŒæ­¥è§„åˆ™**: è®¾ç½®åŒæ­¥æ–¹å‘å’Œè§„åˆ™
- **æŸ¥çœ‹åŒæ­¥çŠ¶æ€**: æ˜¾ç¤ºåŒæ­¥ç»Ÿè®¡å’ŒçŠ¶æ€
- **æ¸…ç†ç¼“å­˜æ–‡ä»¶**: æ¸…ç†è¿‡æœŸçš„æ´»åŠ¨æ–‡ä»¶ç¼“å­˜

#### è‡ªåŠ¨æ¨¡å¼
```bash
# è‡ªåŠ¨æ‰§è¡ŒåŒå‘åŒæ­¥
python main_sync.py --auto

# åªåŒæ­¥ Strava -> Garmin
python main_sync.py --auto --directions strava_to_garmin

# æŒ‡å®šæ‰¹å¤„ç†å¤§å°
python main_sync.py --auto --batch-size 20

# å¯ç”¨è°ƒè¯•æ¨¡å¼
python main_sync.py --debug
```

## ğŸ“‹ ä½¿ç”¨æµç¨‹

1. **é€‰æ‹©æ•°æ®æº**ï¼š
   - Strava APIè‡ªåŠ¨è·å– (æ¨è)
   - æ‰‹åŠ¨è¾“å…¥æ´»åŠ¨ID
   - æä¾›æœ¬åœ°æ–‡ä»¶è·¯å¾„

2. **é€‰æ‹©æ´»åŠ¨**ï¼š
   - ä»æœ€æ–°æ´»åŠ¨åˆ—è¡¨ä¸­é€‰æ‹©
   - è‡ªåŠ¨æ˜¾ç¤ºæ´»åŠ¨è¯¦æƒ…ï¼ˆåç§°ã€ç±»å‹ã€æ—¥æœŸã€è·ç¦»ï¼‰

3. **é€‰æ‹©ä¸Šä¼ å¹³å°**ï¼š
   - IGPSport
   - Garmin Connect
   - å¯å¤šé€‰åŒæ—¶ä¸Šä¼ 

4. **è¾“å…¥å‡­æ®**ï¼š
   - é¦–æ¬¡ä½¿ç”¨éœ€è¦è¾“å…¥å„å¹³å°ç™»å½•ä¿¡æ¯
   - å‡­æ®ä¼šå®‰å…¨ä¿å­˜ä¾›ä¸‹æ¬¡ä½¿ç”¨

5. **è‡ªåŠ¨å¤„ç†**ï¼š
   - æ–‡ä»¶éªŒè¯
   - å¹³å°ä¸Šä¼ 
   - ç»“æœæ‘˜è¦

## ğŸ” æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

- **FIT**ï¼šåŸå§‹è®¾å¤‡æ•°æ®æ ¼å¼ï¼ˆæ¨èï¼‰
- **TCX**ï¼šTraining Center XMLæ ¼å¼
- **GPX**ï¼šGPS Exchangeæ ¼å¼

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main_sync.py              # åŒå‘åŒæ­¥ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ main_refactored.py        # å•å‘ä¸Šä¼ ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ bidirectional_sync.py     # åŒå‘åŒæ­¥æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ sync_manager.py           # åŒæ­¥çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ activity_matcher.py       # æ´»åŠ¨åŒ¹é…ç®—æ³•
â”‚   â”œâ”€â”€ garmin_sync_client.py     # GarminåŒæ­¥å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ strava_client.py          # Stravaå®¢æˆ·ç«¯ï¼ˆæ‰©å±•ï¼‰
â”‚   â”œâ”€â”€ config_manager.py         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ ui_utils.py              # ç”¨æˆ·ç•Œé¢å·¥å…·
â”‚   â””â”€â”€ ...
â”œâ”€â”€ .app_config.json         # ç»Ÿä¸€é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## ğŸ” é…ç½®æ–‡ä»¶è¯´æ˜

`.app_config.json`åŒ…å«æ‰€æœ‰å¹³å°çš„é…ç½®ï¼š

```json
{
  "strava": {
    "client_id": "your_client_id",
    "client_secret": "your_client_secret", 
    "refresh_token": "your_refresh_token",
    "access_token": "",
    "cookie": ""
  },
  "garmin": {
    "username": "your_username",
    "password": "your_password",
    "auth_domain": "GLOBAL"
  },
  "igpsport": {
    "username": "",
    "password": "",
    "login_token": ""
  }
}
```

## ğŸš¨ å¸¸è§é—®é¢˜

### Stravaç›¸å…³
- **APIé…ç½®é—®é¢˜**ï¼šç¡®ä¿æ­£ç¡®é…ç½®Client IDã€Secretå’ŒRefresh Token
- **ä¸‹è½½å¤±è´¥**ï¼šæ£€æŸ¥Cookieæ˜¯å¦æœ‰æ•ˆï¼Œæˆ–é‡æ–°è·å–

### Garmin Connectç›¸å…³
- **ä¾èµ–ç¼ºå¤±**ï¼šè¿è¡Œ`pip install garth`å®‰è£…æ‰€éœ€åº“
- **ç™»å½•å¤±è´¥**ï¼šæ£€æŸ¥ç”¨æˆ·åå¯†ç ï¼Œç¡®è®¤é€‰æ‹©äº†æ­£ç¡®çš„æœåŠ¡å™¨åŒºåŸŸ
- **é‡å¤æ´»åŠ¨**ï¼šGarminä¼šè‡ªåŠ¨æ£€æµ‹é‡å¤æ´»åŠ¨å¹¶æ‹’ç»

### IGPSportç›¸å…³
- **ç™»å½•é—®é¢˜**ï¼šç¡®ä¿ä½¿ç”¨æœ‰æ•ˆçš„IGPSportè´¦æˆ·
- **ä¸Šä¼ å¤±è´¥**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæ–‡ä»¶æ ¼å¼

## ğŸ”„ æ›´æ–°æ—¥å¿—

- **v2.0**ï¼šæ–°å¢Garmin Connectæ”¯æŒï¼Œå¤šå¹³å°åŒæ­¥
- **v1.5**ï¼šç»Ÿä¸€é…ç½®æ–‡ä»¶ï¼Œæ”¹è¿›ç”¨æˆ·ä½“éªŒ
- **v1.0**ï¼šåŸºç¡€Stravaåˆ°IGPSportåŒæ­¥åŠŸèƒ½

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueså’ŒPull Requestsï¼

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹å¸¸è§é—®é¢˜éƒ¨åˆ†
2. ä½¿ç”¨`--debug`æ¨¡å¼è·å–è¯¦ç»†ä¿¡æ¯
3. æäº¤Issueå¹¶é™„å¸¦é”™è¯¯æ—¥å¿—


éœ€è¦ä¸æŒ‚æ¢¯å­ä½¿ç”¨Connectç™»å½•ï¼Œä¼šè‡ªåŠ¨å¼¹å‡ºæ›´æ–°æ‰‹æœºå·